Train samples: 11700
Val samples: 1300
============================================================
Training started at: 2025-12-25 04:01:36.146397
World size: 8 GPUs
Model params: 159,956,768
Batch size: 32 x 8 = 256 effective
Learning rate: 8.00e-04
Condition dropout: 0.1
Validation every 5 epochs
============================================================
Epoch   0 | Batch    0/44 | Loss 1.297647 | LR 8.00e-04 | Uncond: 0/1
>>> Epoch   0 Avg Train Loss: 0.991212
============================================================
Epoch   1 | Batch    0/44 | Loss 0.315891 | LR 8.00e-04 | Uncond: 0/1
>>> Epoch   1 Avg Train Loss: 0.265396
============================================================
Epoch   2 | Batch    0/44 | Loss 0.181978 | LR 8.00e-04 | Uncond: 0/1
>>> Epoch   2 Avg Train Loss: 0.198643
============================================================
Epoch   3 | Batch    0/44 | Loss 0.195437 | LR 8.00e-04 | Uncond: 0/1
>>> Epoch   3 Avg Train Loss: 0.161069
============================================================
Epoch   4 | Batch    0/44 | Loss 0.082625 | LR 8.00e-04 | Uncond: 0/1
>>> Epoch   4 Avg Train Loss: 0.144879
Running validation...
    Val Loss: 0.140136
    Val Loss t=100: 0.367838
    Val Loss t=300: 0.143999
    Val Loss t=500: 0.069403
    Val Loss t=800: 0.022760
    âœ“ New best model saved! Val loss: 0.140136
============================================================
Epoch   5 | Batch    0/44 | Loss 0.099080 | LR 8.00e-04 | Uncond: 0/1
Traceback (most recent call last):
  File "/scratch/vladimir_albrekht/projects/i2m/src/train.py", line 1041, in <module>
  File "/scratch/vladimir_albrekht/projects/i2m/src/train.py", line 893, in train
    predicted_noise = model(noisy_patches, image_patches, t)
    ^^^^^^^^^^^^^^^
  File "/home/vladimir_albrekht/miniconda3/lib/python3.12/site-packages/torch/_tensor.py", line 625, in backward
    torch.autograd.backward(
  File "/home/vladimir_albrekht/miniconda3/lib/python3.12/site-packages/torch/autograd/__init__.py", line 354, in backward
    _engine_run_backward(
  File "/home/vladimir_albrekht/miniconda3/lib/python3.12/site-packages/torch/autograd/graph.py", line 841, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
[rank0]: Traceback (most recent call last):
[rank0]:   File "/scratch/vladimir_albrekht/projects/i2m/src/train.py", line 1041, in <module>
[rank0]:
[rank0]:   File "/scratch/vladimir_albrekht/projects/i2m/src/train.py", line 893, in train
[rank0]:     predicted_noise = model(noisy_patches, image_patches, t)
[rank0]:     ^^^^^^^^^^^^^^^
[rank0]:   File "/home/vladimir_albrekht/miniconda3/lib/python3.12/site-packages/torch/_tensor.py", line 625, in backward
[rank0]:     torch.autograd.backward(
[rank0]:   File "/home/vladimir_albrekht/miniconda3/lib/python3.12/site-packages/torch/autograd/__init__.py", line 354, in backward
[rank0]:     _engine_run_backward(
[rank0]:   File "/home/vladimir_albrekht/miniconda3/lib/python3.12/site-packages/torch/autograd/graph.py", line 841, in _engine_run_backward
[rank0]:     return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: KeyboardInterrupt
